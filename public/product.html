<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" href="misiscoin.css"/>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="fetch.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
<script>
    Telegram.WebApp.expand();
    const params = new URLSearchParams(document.location.search);
    $(document).ready(()=> {
        fetchCommand("productbalance", {productname: params.get("name")}, res=>{
            const balance = res.balance;
            const product = res.product;
            const contributors = res.contributors;

            $('#product').text(`${product.name}: ${product.desc}`);
            $('#balance').text(`${balance.reduce((prev, el)=>prev+el.sum, 0)}`);
            $('#contributors').html(`${contributors.map((el, i)=>`${el.tguserid}: ${el.sum}`).join("<br>")}`);
        }, err=>{
            debugger
        });
    })
</script>
</head>
<body>
    <div id="version"></div>
    <h1>Продукт</h1>
    <div id="product"></div>
    <h1>Баланс</h1>
    <div id="balance"></div>
    <h1>Контрибуторы</h1>
    <div id="contributors"></div>
</body>
</html>
